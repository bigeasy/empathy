<!DOCTYPE html>

<html>
<head>
  <title>readme.t.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>

      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">


                <a class="source" href="empathy.js.html">
                  empathy.js
                </a>


                <a class="source" href="index.js.html">
                  index.js
                </a>


                <a class="source" href="readme.t.js.html">
                  readme.t.js
                </a>

            </div>
          </div>
        </li>
      </ul>

    <ul class="sections">

          <li id="title">
              <div class="annotation">
                  <h1>readme.t.js</h1>
              </div>
          </li>



        <li id="section-1">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>News to me after all these years…</p>
<ul>
<li><a href="https://stackoverflow.com/a/17583612">what is the best way to check variable type in javascript - Michael
Mikowski</a></li>
<li><a href="https://stackoverflow.com/a/14206536">Check whether variable is number or string in JavaScript - Michael
Mikowski</a></li>
<li>[Standard ECMA-262 5.1 Edition - <code>Object.prototype.toString()</code>]
(<a href="https://www.ecma-international.org/ecma-262/5.1/#sec-15.2.4.2">https://www.ecma-international.org/ecma-262/5.1/#sec-15.2.4.2</a>)</li>
</ul>
<p>I never create strings or numbers with a constructor, so I’ve never
encoutered this as a problem. Now I add this library everywhere where I use
<code>typeof</code> so I tought I’d put it somewhere where I could get to it.</p>

            </div>

        </li>


        <li id="section-2">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>This readme document is a unit test from the Empath source code. It uses the
<a href="https://github.com/bigeasy/proof">Proof</a> unit test framework. We’ll be using
the <code>okay</code> method from Proof to assert the points we make about Empathy.</p>
<p>Please run this test yourself.</p>
<pre><code class="language-text">git clone git@github.com:bigeasy/empathy.git
cd empathy
npm install --no-package-lock --no-save
node test/readme.t.js</code></pre>

            </div>

        </li>


        <li id="section-3">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Our unit test begins here.</p>

            </div>

        </li>


        <li id="section-4">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;proof&#x27;</span>)(<span class="hljs-number">21</span>, <span class="hljs-function"><span class="hljs-params">okay</span> =&gt;</span> {</pre></div></div>

        </li>


        <li id="section-5">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>In your program this would be</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> sortof = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;empathy&#x27;</span>)</code></pre>
<p>But we’ll be running this as a unit test as part of CI/CD to ensure that
this readme doesn’t get out of date.</p>

            </div>

        </li>


        <li id="section-6">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> sortof = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;..&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-7">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-8">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p><code>undefined</code> is the same as it is in <code>typeof</code>, but <code>null</code> is no longer
<code>object</code>. It is <code>null</code>.</p>

            </div>

        </li>


        <li id="section-9">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    okay(sortof([][<span class="hljs-number">0</span>]), <span class="hljs-string">&#x27;undefined&#x27;</span>, <span class="hljs-string">&#x27;is undefined&#x27;</span>)
    okay(sortof(<span class="hljs-literal">null</span>), <span class="hljs-string">&#x27;null&#x27;</span>, <span class="hljs-string">&#x27;is null&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-10">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-11">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Wrapped primitives are the same as their primitive values.</p>

            </div>

        </li>


        <li id="section-12">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    okay(sortof(<span class="hljs-string">&#x27;x&#x27;</span>), <span class="hljs-string">&#x27;string&#x27;</span>, <span class="hljs-string">&#x27;is string&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">&#x27;x&#x27;</span>)), <span class="hljs-string">&#x27;string&#x27;</span>, <span class="hljs-string">&#x27;is still string&#x27;</span>)
    okay(sortof(<span class="hljs-literal">true</span>), <span class="hljs-string">&#x27;boolean&#x27;</span>, <span class="hljs-string">&#x27;is boolean&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Boolean</span>(<span class="hljs-literal">true</span>)), <span class="hljs-string">&#x27;boolean&#x27;</span>, <span class="hljs-string">&#x27;is still boolean&#x27;</span>)
    okay(sortof(<span class="hljs-number">1</span>), <span class="hljs-string">&#x27;number&#x27;</span>, <span class="hljs-string">&#x27;is number&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Number</span>(<span class="hljs-number">1</span>)), <span class="hljs-string">&#x27;number&#x27;</span>, <span class="hljs-string">&#x27;is still number&#x27;</span>)
    okay(sortof(<span class="hljs-number">1n</span>), <span class="hljs-string">&#x27;bigint&#x27;</span>, <span class="hljs-string">&#x27;is bigint&#x27;</span>)
    okay(sortof(BigInt(<span class="hljs-number">1</span>)), <span class="hljs-string">&#x27;bigint&#x27;</span>, <span class="hljs-string">&#x27;is still bigint&#x27;</span>)
    okay(sortof(<span class="hljs-built_in">Symbol</span>(<span class="hljs-string">&#x27;x&#x27;</span>)), <span class="hljs-string">&#x27;symbol&#x27;</span>, <span class="hljs-string">&#x27;is symbol&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-13">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-14">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    okay(sortof(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{}), <span class="hljs-string">&#x27;function&#x27;</span>, <span class="hljs-string">&#x27;is function&#x27;</span>)
    okay(sortof(<span class="hljs-function">() =&gt;</span> {}), <span class="hljs-string">&#x27;function&#x27;</span>, <span class="hljs-string">&#x27;is also function&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(<span class="hljs-string">&#x27;return 1&#x27;</span>)), <span class="hljs-string">&#x27;function&#x27;</span>, <span class="hljs-string">&#x27;is still function&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-15">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-16">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Arrays are not <code>object</code> but <code>array</code>. This makes life easier in switch
statements.</p>

            </div>

        </li>


        <li id="section-17">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    okay(sortof([]), <span class="hljs-string">&#x27;array&#x27;</span>, <span class="hljs-string">&#x27;is array&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">0</span>)), <span class="hljs-string">&#x27;array&#x27;</span>, <span class="hljs-string">&#x27;is still array&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-18">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-19">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Object is <code>object</code> and derived classes are still <code>object</code>.</p>

            </div>

        </li>


        <li id="section-20">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    okay(sortof({}), <span class="hljs-string">&#x27;object&#x27;</span>, <span class="hljs-string">&#x27;is object&#x27;</span>)
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> </span>{}
    okay(sortof(<span class="hljs-keyword">new</span> Example), <span class="hljs-string">&#x27;object&#x27;</span>, <span class="hljs-string">&#x27;is still object&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-21">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-22">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>This is an important departure from <code>typeof</code> but I find these to be
helpful so I’ve not corrected them.</p>

            </div>

        </li>


        <li id="section-23">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">0</span>)), <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;is date&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>()), <span class="hljs-string">&#x27;map&#x27;</span>, <span class="hljs-string">&#x27;is map&#x27;</span>)
    okay(sortof(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>()), <span class="hljs-string">&#x27;set&#x27;</span>, <span class="hljs-string">&#x27;is set&#x27;</span>)</pre></div></div>

        </li>


        <li id="section-24">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-25">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Here is the counter example form the landing page. First type <code>typeof</code>
implementation.</p>

            </div>

        </li>


        <li id="section-26">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    {
        <span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;assert&#x27;</span>)

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">counter</span> (<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> value) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;object&#x27;</span>: {
                    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
                    }
                    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(value)) {
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> value) {
                            sum += counter(item)
                        }
                        <span class="hljs-keyword">return</span> sum
                    }
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> name <span class="hljs-keyword">in</span> value) {
                        sum += counter(value[name])
                    }
                    <span class="hljs-keyword">return</span> sum
                }
            <span class="hljs-attr">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
            }
        }

        assert.equal(counter({ <span class="hljs-attr">a</span>: <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-attr">b</span>: [ <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&#x27;z&#x27;</span> ] }), <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;found three scalar values&#x27;</span>)
    }</pre></div></div>

        </li>


        <li id="section-27">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>

            </div>

        </li>


        <li id="section-28">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>And now the empathy implementation.</p>

            </div>

        </li>


        <li id="section-29">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>    {
        <span class="hljs-keyword">const</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;assert&#x27;</span>)

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">counter</span> (<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">switch</span> (sortof(value)) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;array&#x27;</span>: {
                    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> value) {
                        sum += counter(item)
                    }
                    <span class="hljs-keyword">return</span> sum
                }
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;object&#x27;</span>: {
                    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">in</span> value) {
                        sum += counter(value[item])
                    }
                    <span class="hljs-keyword">return</span> sum
                }
            <span class="hljs-attr">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
            }
        }

        assert.equal(counter({ <span class="hljs-attr">a</span>: <span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-attr">b</span>: [ <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&#x27;z&#x27;</span> ] }), <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;found three scalar values&#x27;</span>)
    }
})</pre></div></div>

        </li>

    </ul>
  </div>
</body>
</html>
